---
title: "Mordvin Varieties"
date: "9/2/2019"
author: "Jack Rueter"
output: 
  html_document:
    toc: true
    toc_float:
      toc_collapsed: true
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages, echo=FALSE, warning=FALSE}
# install.packages("tidyverse")
# install.packages("leaflet")

list.of.packages <- c("rmarkdown", "tidyverse", "leaflet")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)

suppressPackageStartupMessages(library(tidyverse))
library(leaflet)
```


```{r helper_functions, echo=FALSE}

my_colors <-
  c(
    "#1f77b4",
    "#ff7f0e",
    "#2ca02c",
    "#d62728",
    "#9467bd",
    "#8c564b",
    "#e377c2",
    "#7f7f7f",
    "#17becf",
    sample(grDevices::colors()[!grepl("ivory|azure|white|gray|grey|black|pink|1",
                                      grDevices::colors())])
  )

```

```{r process_files, echo=FALSE, warning=FALSE, message=FALSE}
read_mordva_file <- function(filename){
  
  read_csv(filename) %>% 
    slice(-1) %>%
    mutate(language = "Mordva") %>%
    mutate(coordinate = str_trim(coordinate)) %>%
    separate(coordinate, into = c("latitude", "longitude"), sep = ", ") %>%
    mutate(latitude = as.numeric(latitude)) %>%
    mutate(longitude = as.numeric(longitude))
  
}

make_mordva_map <- function(mordva_dataframe){
  
  pal <- colorFactor({my_colors[1:length(unique(mordva_dataframe$dialect))]},
                   domain = mordva_dataframe$dialect)
  
  leaflet(data = mordva_dataframe, width = "100%") %>%
    addTiles() %>%
    addCircleMarkers(popup = ~id,
                     color = ~pal(dialect),
                     radius = 5,
                     stroke = FALSE, 
                     fillOpacity = 1,
                     lat = ~latitude,
                     lng = ~longitude) %>%
    addLegend("bottomright", pal = pal, values = ~dialect,
                     title = "Dialect codes",
#                     labFormat = labelFormat(prefix = "$"),
                     opacity = 1
                 )
  
}

PMW_locale_01 <- read_mordva_file("PMW_locale_01.csv")
PMW_Erzya_locale_01 <- read_mordva_file("PMW_Erzya-locale_01.csv")
PMW_Moksha_locale_01 <- read_mordva_file("PMW_Moksha-locale_01.csv")
```

## Map of Paasonen's fieldwork (1891–1912) of the Erzya and Moksha
These are all locales, Erzya and Moksha, where fieldwork materials
were collected for and Heikki Paasonen 1891–1912. 
The dialects of each language within the Republic of Mordovia 
have been classified as five groups by Aleksandr Pavlovich Feoktistov. 
The some locales have not been classified, especially outside of the 
Republic, and other locales have more than one classification.
By clicking the dot, you will reveal the location.

```{r,echo=FALSE}
make_mordva_map(PMW_locale_01)
```

## Map of Paasonen's fieldwork (1891–1912) among the Erzya
These are Erzya locales where fieldwork materials
were collected for and by Heikki Paasonen 1891–1912.

```{r,echo=FALSE}
make_mordva_map(PMW_Erzya_locale_01)
```

## Map of Paasonen's fieldwork (1891–1912) among the Moksha
These are Moksha locales where fieldwork materials
were collected for and by Heikki Paasonen 1891–1912.

```{r,echo=FALSE}
make_mordva_map(PMW_Moksha_locale_01)
```

